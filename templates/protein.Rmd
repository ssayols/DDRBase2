---
title: "<<GENE.ID>>"
description: |
  <<PROTEIN.NAME>>
site: distill::distill_website
---

```{r setup, include=FALSE}
library(ggplot2)
library(plotly)
knitr::opts_chunk$set(echo = FALSE)

# Learn more about creating websites with Distill at:
# https://rstudio.github.io/distill/website.html

```

# <<GENE.ID>> ‚ùØ <<PROTEIN.ID>>

## Gene names
<<GENE.NAME>>

## Function
<<FUNCTION>>

## Keywords
<<KEYWORDS>>

<p>Source: https://www.uniprot.org/</p>


## Phosphorilation

```{r phospho_plot}
# read data
data <- readRDS("<<DATA>>")

if(nrow(data) > 0) {
  # convert back to wide. Some positions have to read-outs: aggregate them (max log2FC)
  treatments <- c("Aphidicoline",  "Camptothecin", "Etoposide", "Formaldehyd", "Gemcitabine", "Hydrogen peroxide",  "Hydroxyurea", "Methyl methanesulfonate", "Sodium Arsentie (NaAsO2)", "UV-C", "X-ray")
  m <- reshape2::dcast(data[, c("Mod..position", "Treatment", "log2FC")],
                       Mod..position ~ Treatment,
                       value.var="log2FC",
                       fun.aggregate=max) %>% reshape2::melt()
  o    <- rev(order(as.numeric(sapply(unique(m$Mod..position), function(x) strsplit(x, ";")[[1]][1]))))  # 1st coord order
  m$position  <- factor(m$Mod..position, levels=unique(m$Mod..position)[o])
  m$treatment <- m$variable
  m$log2FC    <- m$value
  
  ggplotly(
    ggplot(m, aes(x=treatment, y=position, fill=log2FC)) +
      geom_tile() +
      scale_fill_gradient2(name="log2 FC") +
      labs(x="", y="") +
      theme_minimal() +
      theme(axis.text.x=element_text(angle=90, vjust=0.5, hjust=1))
  ) %>% config(displaylogo= FALSE, 
               modeBarButtonsToRemove=c("zoom2d", "pan2d", "select2d", "lasso2d",
                                        "zoomIn2d", "zoomOut2d", "autoScale2d", "toggleSpikelines"))
} else {
  cat("Not detected.", fill=TRUE)
}
```
